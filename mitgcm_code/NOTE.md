**NOTE:** these code modifications are based on checkpoint **69a**

See `the_model_main.F` for a summary on the order of the codes.
